<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MENA Releases</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0; padding: 0;
  }
  header {
    padding: 10px;
    background: #f2f2f2;
    text-align: center;
  }
  header h1 {
    margin: 0;
  }
  header p {
    margin: 3px 0;
  }
  header .small-text {
    font-size: 0.9em;
    color: #555;
  }
  #filters {
    padding: 10px;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    background: #fafafa;
    border-bottom: 1px solid #ddd;
  }
  #filters label {
    font-weight: bold;
    margin-right: 5px;
  }
  #filters select, #filters input {
    padding: 3px;
  }
  main {
    display: flex;
    flex-direction: row;
  }
  #table-container {
    flex: 2;
    overflow-x: auto;
    padding: 10px;
  }
  table {
    border-collapse: collapse;
    width: 100%;
  }
  table th, table td {
    border: 1px solid #ddd;
    padding: 6px;
    text-align: left;
    vertical-align: top;
  }
  table th {
    background: #f4f4f4;
    cursor: pointer;
  }
  /* Release name wraps */
  td.release-name {
    white-space: normal;
    word-wrap: break-word;
    max-width: 250px;
  }
  /* Fixed widths for date & gender */
  td.release-date {
    width: 120px;
  }
  td.gender {
    width: 80px;
  }
  #charts {
    flex: 1;
    padding: 10px;
  }
  @media (max-width: 768px) {
    main {
      flex-direction: column;
    }
    #charts {
      order: -1;
    }
    /* Put date filters side by side on mobile */
    .date-range {
      display: flex;
      gap: 5px;
    }
  }
</style>
</head>
<body>

<header>
  <h1>MENA Releases</h1>
  <p>brought to you by MENAMUSICINDUSTRY meme page. Data powered by MusicBrainz.</p>
  <p class="small-text">Follow me on Instagram: <a href="https://instagram.com/menamusicindustry" target="_blank">@menamusicindustry</a></p>
  <p class="small-text">Database is updated weekly or whenever I feel like it.</p>
</header>

<section id="filters">
  <div>
    <label>Artist Name:</label>
    <input type="text" id="artistFilter" placeholder="Search artist...">
  </div>
  <div>
    <label>Label Name:</label>
    <input type="text" id="labelFilter" placeholder="Search label...">
  </div>
  <div>
    <label>Artist Country:</label>
    <select id="countryFilter" multiple size="4"></select>
  </div>
  <div>
    <label>Gender:</label>
    <select id="genderFilter" multiple size="3">
      <option value="Male">Male</option>
      <option value="Female">Female</option>
    </select>
  </div>
  <div class="date-range">
    <div>
      <label>Release Date (start):</label>
      <input type="date" id="startDate">
    </div>
    <div>
      <label>Release Date (end):</label>
      <input type="date" id="endDate">
    </div>
  </div>
  <div>
    <button id="clearFilters">Clear Filters</button>
  </div>
</section>

<main>
  <div id="table-container">
    <table id="releasesTable">
      <thead>
        <tr>
          <th data-sort="artist">Artist</th>
          <th data-sort="release">Release Name</th>
          <th data-sort="country">Country</th>
          <th data-sort="label">Label Name</th>
          <th data-sort="date">Release Date</th>
          <th data-sort="gender">Gender</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div id="pagination"></div>
  </div>
  <div id="charts">
    <canvas id="topArtistsChart"></canvas>
    <canvas id="topCountriesChart"></canvas>
    <canvas id="genderPieChart"></canvas>
  </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// --- Example JS logic (replace with your real fetch code) ---
const tableBody = document.querySelector("#releasesTable tbody");

function renderTable(data) {
  tableBody.innerHTML = "";
  data.forEach(row => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${row.artist}</td>
      <td class="release-name">${row.release}</td>
      <td>${row.country}</td>
      <td>${row.label || ""}</td>
      <td class="release-date">${row.date || ""}</td>
      <td class="gender">${row.gender || ""}</td>
    `;
    tableBody.appendChild(tr);
  });
}

// Example placeholder data:
renderTable([
  { artist: "Paul Bowles", release: "Baptism of Solitude", country: "Morocco", label: "Example Label", date: "1995-01-01", gender: "Male" },
  { artist: "Test Artist", release: "A Very Long Release Name That Should Wrap Correctly In The Table Cell Without Expanding Too Much Horizontally", country: "Egypt", label: "Label X", date: "2000-05-20", gender: "Female" }
]);

// Chart placeholder:
const genderCtx = document.getElementById("genderPieChart");
new Chart(genderCtx, {
  type: "pie",
  data: {
    labels: ["Male", "Female"],
    datasets: [{
      data: [60, 40],
      backgroundColor: ["#6baed6", "#9ecae1"]
    }]
  },
  options: {
    plugins: {
      tooltip: {
        callbacks: {
          label: function(context) {
            const total = context.dataset.data.reduce((a,b) => a + b, 0);
            const value = context.parsed;
            const pct = ((value / total) * 100).toFixed(1) + "%";
            return `${context.label}: ${value} (${pct})`;
          }
        }
      }
    }
  }
});
</script>
</body>
</html>
